<UserControl x:Class="BankingEcosystem.Admin.UI.Views.CustomerDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource BackgroundBrush}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32,24" MaxWidth="900">

            <!-- Back Button -->
            <Button Content="â† Kembali" Command="{Binding GoBackCommand}"
                    HorizontalAlignment="Left" Margin="0,0,0,16"
                    Background="Transparent" Foreground="{StaticResource PrimaryBrush}"
                    BorderThickness="0" FontSize="13" Cursor="Hand" />

            <!-- Customer Info Card -->
            <Border Background="White" CornerRadius="8" Padding="24" Margin="0,0,0,20"
                    BorderBrush="#E0E0E0" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="{Binding CustomerName}" FontSize="22" FontWeight="Bold"
                               Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,12" />

                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,8">
                        <TextBlock Text="NIK" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding Nik}" FontSize="14" FontWeight="SemiBold" />
                    </StackPanel>
                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                        <TextBlock Text="Telepon" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding Phone}" FontSize="14" FontWeight="SemiBold" />
                    </StackPanel>
                    <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,0,8">
                        <TextBlock Text="Email" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding Email}" FontSize="14" />
                    </StackPanel>
                    <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,0,0,8">
                        <TextBlock Text="Tanggal Lahir" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding DateOfBirth}" FontSize="14" />
                    </StackPanel>
                    <StackPanel Grid.Row="3" Grid.Column="0">
                        <TextBlock Text="Alamat" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding Address}" FontSize="14" TextWrapping="Wrap" />
                    </StackPanel>
                    <StackPanel Grid.Row="3" Grid.Column="1">
                        <TextBlock Text="Terdaftar" FontSize="11" Foreground="{StaticResource SubtextBrush}" />
                        <TextBlock Text="{Binding CreatedAt}" FontSize="14" />
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Accounts Section -->
            <TextBlock Text="Rekening" FontSize="18" FontWeight="SemiBold"
                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,8" />

            <DataGrid ItemsSource="{Binding Accounts}" AutoGenerateColumns="False" IsReadOnly="True"
                      CanUserAddRows="False" Background="White" BorderBrush="#E0E0E0" BorderThickness="1"
                      RowHeight="34" FontSize="12" Margin="0,0,0,8" MaxHeight="200">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="No. Rekening" Binding="{Binding AccountNumber}" Width="*" />
                    <DataGridTextColumn Header="Jenis" Binding="{Binding AccountTypeName}" Width="120" />
                    <DataGridTextColumn Header="Saldo" Binding="{Binding Balance, StringFormat=Rp {0:N0}}" Width="140" />
                    <DataGridTextColumn Header="Limit Harian" Binding="{Binding DailyLimit, StringFormat=Rp {0:N0}}" Width="130" />
                    <DataGridTextColumn Header="Status" Binding="{Binding IsActive}" Width="70" />
                </DataGrid.Columns>
            </DataGrid>

            <!-- Open Account Form -->
            <Border Background="#F0F4F8" CornerRadius="6" Padding="16" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Buka Rekening Baru" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,8" />
                    <WrapPanel>
                        <ComboBox ItemsSource="{Binding AccountTypes}" SelectedItem="{Binding SelectedAccountType}"
                                  DisplayMemberPath="TypeName" Width="180" Height="30" Margin="0,0,8,0" />
                        <TextBox Text="{Binding InitialDeposit, UpdateSourceTrigger=PropertyChanged}"
                                 Width="140" Height="30" Margin="0,0,8,0" VerticalContentAlignment="Center"
                                 Tag="Setoran Awal" />
                        <Button Content="Buka Rekening" Command="{Binding OpenAccountCommand}"
                                Style="{StaticResource PrimaryButtonStyle}" Height="30" Padding="12,0" FontSize="12" />
                    </WrapPanel>
                </StackPanel>
            </Border>

            <!-- Cards Section -->
            <TextBlock Text="Kartu Debit" FontSize="18" FontWeight="SemiBold"
                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,8" />

            <DataGrid ItemsSource="{Binding Cards}" AutoGenerateColumns="False" IsReadOnly="True"
                      CanUserAddRows="False" Background="White" BorderBrush="#E0E0E0" BorderThickness="1"
                      RowHeight="34" FontSize="12" Margin="0,0,0,8" MaxHeight="180">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="No. Kartu" Binding="{Binding CardNumber}" Width="*" />
                    <DataGridTextColumn Header="Rekening" Binding="{Binding AccountNumber}" Width="150" />
                    <DataGridTextColumn Header="Kadaluarsa" Binding="{Binding ExpiryDate, StringFormat=MM/yyyy}" Width="100" />
                    <DataGridTextColumn Header="Blokir" Binding="{Binding IsBlocked}" Width="70" />
                </DataGrid.Columns>
            </DataGrid>

            <!-- Issue Card Form -->
            <Border Background="#F0F4F8" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Terbitkan Kartu Baru" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,8" />
                    <WrapPanel>
                        <ComboBox ItemsSource="{Binding Accounts}" SelectedItem="{Binding SelectedAccountForCard}"
                                  DisplayMemberPath="AccountNumber" Width="180" Height="30" Margin="0,0,8,0" />
                        <PasswordBox x:Name="PinBox" Width="100" Height="30" MaxLength="6" Margin="0,0,8,0"
                                     PasswordChanged="OnPinChanged" />
                        <Button Content="Terbitkan Kartu" Command="{Binding IssueCardCommand}"
                                Style="{StaticResource PrimaryButtonStyle}" Height="30" Padding="12,0" FontSize="12" />
                    </WrapPanel>
                </StackPanel>
            </Border>

            <!-- Status Message -->
            <TextBlock Text="{Binding StatusMessage}" FontSize="13" Foreground="#27AE60"
                       FontWeight="SemiBold" Margin="0,0,0,16"
                       Visibility="{Binding HasStatusMessage, Converter={StaticResource BoolToVisConverter}}" />

        </StackPanel>
    </ScrollViewer>
</UserControl>
